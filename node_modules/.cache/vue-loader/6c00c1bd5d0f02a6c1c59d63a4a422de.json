{"remainingRequest":"/Users/fbecker/Documents/Uni/mentalrotation3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fbecker/Documents/Uni/mentalrotation3/node_modules/magpie-base/src/components/screens/EyetrackingValidationScreen.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fbecker/Documents/Uni/mentalrotation3/node_modules/magpie-base/src/components/screens/EyetrackingValidationScreen.vue","mtime":1642626386074},{"path":"/Users/fbecker/Documents/Uni/mentalrotation3/node_modules/cache-loader/dist/cjs.js","mtime":1642626384207},{"path":"/Users/fbecker/Documents/Uni/mentalrotation3/node_modules/vue-loader/lib/index.js","mtime":1642626384903}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTY3JlZW4gZnJvbSAnLi4vU2NyZWVuJzsKaW1wb3J0IFNsaWRlIGZyb20gJy4uL1NsaWRlJzsKaW1wb3J0IEV5ZXRyYWNraW5nU3RhcnQgZnJvbSAnLi4vaGVscGVycy9FeWV0cmFja2luZ1N0YXJ0JzsKaW1wb3J0IFdhaXQgZnJvbSAnLi4vaGVscGVycy9XYWl0JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdFeWV0cmFja2luZ1ZhbGlkYXRpb25TY3JlZW4nLAogIGNvbXBvbmVudHM6IHsgV2FpdCwgRXlldHJhY2tpbmdTdGFydCwgU2xpZGUsIFNjcmVlbiB9LAogIHByb3BzOiB7CiAgICBwcmVjaXNpb246IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAxMDAKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB4OiAwLAogICAgICB5OiAwLAogICAgICBjYWxpYnJhdGlvblNlcXVlbmNlOiBbXQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICB3aW5kb3dIZWlnaHQoKSB7CiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICB9LAogICAgd2luZG93V2lkdGgoKSB7CiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aDsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIG1lYXN1cmVBY2N1cmFjeSgpIHsKICAgICAgY29uc3QgdHJhY2sgPSB0aGlzLiRtYWdwaWUuZXlldHJhY2tpbmcuZ2V0RXllVHJhY2soKTsKICAgICAgY29uc3QgdGFyZ2V0ID0geyB4OiB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsIHk6IHdpbmRvdy5pbm5lckhlaWdodCAvIDIgfTsKICAgICAgbGV0IGFjY3VyYXRlQ291bnQgPSAwLAogICAgICAgIGRYLAogICAgICAgIGRZLAogICAgICAgIGRpc3RhbmNlOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYWNrLmV0X3gubGVuZ3RoOyBpKyspIHsKICAgICAgICBkWCA9IHRhcmdldC54IC0gdHJhY2suZXRfeFtpXTsKICAgICAgICBkWSA9IHRhcmdldC55IC0gdHJhY2suZXRfeVtpXTsKICAgICAgICBkaXN0YW5jZSA9IE1hdGguc3FydChkWCAqKiAyICsgZFkgKiogMik7CiAgICAgICAgaWYgKGRpc3RhbmNlIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGFjY3VyYXRlQ291bnQrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgYWNjdXJhY3kgPSBhY2N1cmF0ZUNvdW50IC8gdHJhY2suZXRfeC5sZW5ndGg7CgogICAgICBjb25zb2xlLmxvZygnRXlldHJhY2tpbmcgYWNjdXJhY3kgYWZ0ZXIgY2FsaWJyYXRpb246JywgYWNjdXJhY3kpOwoKICAgICAgdGhpcy4kbWFncGllLmFkZEV4cERhdGEoeyBldF9hY2N1cmFjeTogYWNjdXJhY3kgfSk7CiAgICAgIHRoaXMuJG1hZ3BpZS5uZXh0U2NyZWVuKCk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["EyetrackingValidationScreen.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA","file":"EyetrackingValidationScreen.vue","sourceRoot":"node_modules/magpie-base/src/components/screens","sourcesContent":["<docs>\nThis screen is used to initialize and calibrate eye tracking.\nEyetracking requires that you install `webgazer`.\n\n```vue\n<Experiment wide>\n  <InstructionScreen>\n    Click the button to start full screen.\n  </InstructionScreen>\n\n  <InstructionScreen>\n    <FullScreenStart />\n    Click the button to start calibration.\n  </InstructionScreen>\n\n  <!-- We'll set debugging to true so you can see something -->\n  <EyetrackingCalibrationScreen debug />\n\n  <EyetrackingValidationScreen />\n\n  <InstructionScreen>\n    Successfully calibrated!\n  </InstructionScreen>\n\n</Experiment>\n```\n</docs>\n\n<template>\n  <Screen v-bind=\"$attrs\">\n    <!-- Check accuracy -->\n    <Slide>\n      <p>Please stare at the blue dot in the center.</p>\n      <Wait :time=\"5000\" @done=\"measureAccuracy\" />\n      <EyetrackingStart />\n      <CanvasStage\n        ref=\"checkpoint\"\n        :config=\"{ width: 26, height: 26 }\"\n        :style=\"{ top: windowHeight / 2 + 'px', left: windowWidth / 2 + 'px' }\"\n        class=\"point check\"\n      >\n        <CanvasLayer>\n          <CanvasCircle\n            :config=\"{\n              x: 13,\n              y: 13,\n              fill: 'lightblue',\n              radius: 12,\n              stroke: 'black',\n              strokeWidth: 1\n            }\"\n          ></CanvasCircle>\n        </CanvasLayer>\n      </CanvasStage>\n    </Slide>\n    <Slide>\n      <p>Something went wrong. Please reload the page.</p>\n    </Slide>\n  </Screen>\n</template>\n\n<script>\nimport Screen from '../Screen';\nimport Slide from '../Slide';\nimport EyetrackingStart from '../helpers/EyetrackingStart';\nimport Wait from '../helpers/Wait';\nexport default {\n  name: 'EyetrackingValidationScreen',\n  components: { Wait, EyetrackingStart, Slide, Screen },\n  props: {\n    precision: {\n      type: Number,\n      default: 100\n    }\n  },\n  data() {\n    return {\n      x: 0,\n      y: 0,\n      calibrationSequence: []\n    };\n  },\n  computed: {\n    windowHeight() {\n      return window.innerHeight;\n    },\n    windowWidth() {\n      return window.innerWidth;\n    }\n  },\n  methods: {\n    measureAccuracy() {\n      const track = this.$magpie.eyetracking.getEyeTrack();\n      const target = { x: window.innerWidth / 2, y: window.innerHeight / 2 };\n      let accurateCount = 0,\n        dX,\n        dY,\n        distance;\n      for (let i = 0; i < track.et_x.length; i++) {\n        dX = target.x - track.et_x[i];\n        dY = target.y - track.et_y[i];\n        distance = Math.sqrt(dX ** 2 + dY ** 2);\n        if (distance < this.precision) {\n          accurateCount++;\n        }\n      }\n      const accuracy = accurateCount / track.et_x.length;\n\n      console.log('Eyetracking accuracy after calibration:', accuracy);\n\n      this.$magpie.addExpData({ et_accuracy: accuracy });\n      this.$magpie.nextScreen();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.point {\n  position: absolute;\n}\n\n.point.check {\n  position: fixed;\n}\n</style>\n"]}]}